# 基于密集连接CNN网络的公路场景蜂窝网络移动流量预测（*Mobile Traffic Prediction Based on Densely Connected CNN for Cellular Networks in Highway Scenarios*）

> 单位：北京邮电大学 - 无线信号处理与网络实验室
> 
> 作者：梁栋天

> 关键词：*Big data*（大数据），*Traffic prediction*（流量预测），*Highway*（公路），*Deep learning*（深度学习）

## 1 摘要
  - 选题背景：
    - 无线大数据成为运营商管理与提升无线通信系统的推动力
    - 少有预测方法结合基站分布特征预测蜂窝网络移动业务量
  - 本文内容：
    - 数据来源：中国东南典型城市收集的*4G*移动数据
    - 算法：基于一维密集连接卷积神经网络（*DenseNet-CNN*）的移动流量预测 
    - 方法：数据采集，数据分析和建模
    - 对比：
      - 本文提出的预测方法 
      - 广泛使用的基于机器学习模型（*LSTM*、*SVR*）的预测方法 
    - 结论：本文的算法表现了出色性能 

## 2 绪论与研究综述
### 1.1 选题背景
  - 现状：通信流量爆炸增长
    - 到$2022$年，将有$123$亿台移动连接设备
    - $2017\sim 2022$年，将有$46\%$的复合年增长率
    - 到$2022$年，每月产生流量将达$77.5$艾字节
  - 结论：迫切需要实现对移动基站流量的精确预测，以对无线蜂窝网络进行管理与改进
### 1.2 文献综述
  - 现有研究
    - 时域分析：从时域角度预测移动流量 
    - 空域分析：使用系统架构演进(*SAE*)了解空域对移动流量的影响 
    - 流量预测：使用*Telecom Italia Big Data Challenge*数据预测城市蜂窝网络的移动流量 
  - 不足之处
    - 未考虑一维分布特性的基站(尤其是高速场景) 
### 1.3 文章结构
  - 分析体系
    - 分析高速场景中蜂窝网络的流量模式(时域，空域) 
    - 提出新的移动流量预测方案 
      - 一维密集连接卷积神经网络 
      - 一维网格流图建模 
    - 评估所提出的方案的有效性
  - 本文贡献
    - 综合分析高速场景中无线网络流量的时空相关性 
    - 预测高速场景的移动基站流量的全新方法 
 
## 2 数据预处理
### 2.1 数据简介
  - 数据来源
    - 中国东南地区典型城市的*4G*移动数据 
    - 基于*Hadoop*的移动大数据处理平台    
  - 数据特点
    - 数据大小：$\rm 39.5GB$
    - 数据记录时间：$\rm 00:00:00 08/16/2018 ~ 23:00:00 11/14/2018$（$91$天, $2184$小时）
  - 数据记录时间间隔：$1$小时
  - 使用到的数据内容：各基站上行与下行链路流量  
### 2.2 分析高速场景的时空相关性
  - 分析对象选择
    - 分析区域
      - 蓝色链状基站带的选定红色矩形部分 
    - 分析对象
      - 选定区域中典型基站(蓝色点)的移动流量
![分析对象选择](https://cdn.jsdelivr.net/gh/AmaneHayashi/PictureBed/20200630193457.png)
  - 时间相关性
    - 分析参数
      - 每周经验均值 
      - 实际采样值 
      - 标准差 
    - 分析方法
      - 绘制数据流量、均值、均值±标准差在一周内随时间变化的图像
    - 结论
      - 平均值曲线有明显周期性 
      - 强自相关性 
![时间相关性](https://cdn.jsdelivr.net/gh/AmaneHayashi/PictureBed/20200630193532.png)
  - 空间相关性
    - 参数
      - 分析参数
        - 相关系数$\rho(x,y)=\frac{\mathrm{cov}(bs_x,bs_y)}{\sigma_{bs_x},\sigma_{bs_y}}$(注：$bs$为上下行链路流量，$\mathrm{cov}$为协方差算子，$\sigma$为标准差) 
    - 结论
      - 强互相关性  
      - 时空相关性可用于提升预测精度
![空间相关性](https://cdn.jsdelivr.net/gh/AmaneHayashi/PictureBed/20200630193540.png)

### 2.3 网格流图建模
  - 预处理
    - 预设
      - 使用小网格估计基站覆盖范围 
      - 仅利用经度或纬度划分所选区域 
      - 每个网格划归于最近邻基站 
      - 每个网格的上下行链路流量为网格流量的平均 
    - 预处理
      - 分为$M\times{1}$或$1\times{N}$的网格（$M$为宽度，$N$为高度，实际取值$M=40$，$N=1$，共$17$个基站）
      - 使用网格中点的经纬度代表网格及其基站的经纬度 
      - 使用*Haversine*公式计算网格到各基站距离，式中$\Delta()=()_b-()_a$，$H(\theta)=\sin^2\left(\frac{\theta}{2}\right)$，$r$为地球半径，$\phi$为经度，$\lambda$为纬度
      $$D=2r\sin^{-1}\left(H(\Delta\phi)+\cos(\phi_a)cos(\phi_b)H(\Delta\lambda)\right)$$
  - 图像绘制
    - 数据处理
      - 使用的数据可划分为
        - 最近$p$小时的近邻数据
        - 最近$q$天的周期数据
        - 实际使用时，$p=3，q=3$
      - 舍弃前$72$小时数据(前$72$小时没有周期数据)
      - 最后$3$周数据为测试集($1608$小时数据作为训练集，$504$小时数据作为测试集)
    - 图像绘制
      - 将每小时的各网格(共$M\times{N}$格)各链路(共上下行$2$路)的流量数据看作一个张量
      $$D_t\in R^{M\times N\times 2},t=1,2,\cdots,2184$$
      - 输入一共为$p+q$个$M\times{N}$张量，分别训练上行链路与下行链路流量
      - 模型的输出(即预测结果)满足
      $$\hat{D}_{t+1}={}\arg\max\limits_{D_{t+1}} p\left(D_{t+1}\vert D_{t-i+1},D_{t-j\times 24+1}\right),i=1,\cdots,p,1,\cdots,q$$

## 3 建立预测模型
### 3.1 *DenseNet*简介
  - 本质：*CNN*的变种
  - 结构：$L$层*dense-block*结构
  - 原理：对于第$l$层，有：
    - 输入的特征图数为$k_l$，式中，$k_0$为输入层通道数，$k$为每层输出的特征图数(也称作增长率)
    $$k_l=k_0+k(l-1)$$
    - 输出为$x_l$，式中，$f()$函数由*BN+ReLU+Conv*组成，$[\cdot]$表示级联
    $$x_l=f_l\left([x_0,x_1,\cdots,x_{l-1}]\right)$$
  - 优点(相比于传统CNN)
    - 缓解梯度消失问题(解释:每一层都包含之前所有层的输出信息，实现了特征的重复利用，故只需要需要很少的特征图，需要的参数数目大大减少)
    - 减少训练参数数量(解释:跨层连接的设计使得每一层都”直接”连接*input*层和*loss*层，浅层的参数也能学习到深层的*loss*从而得到充分训练)
![DenseNet](https://cdn.jsdelivr.net/gh/AmaneHayashi/PictureBed/20200630193544.png)
### 3.2 一维卷积预测模型
  - 模型特点：
    - 本质：两个相同结构的平行*DenseNet*(一路处理近邻数据，一路处理周期数据)
    - 处理：使用一维卷积简化计算复杂度
    - 原理：两路输出通过*sigmoid*函数得到最终输出，即：$X_o=\sigma\left(X_c+X_p\right)$
  - 参数选择：
    - *dense-block*结构数：$6$
    - 增长率：$12$
    - 学习率：$0.001$(第$150$轮，$225$轮时除以$10$)
    - 优化器：*Adam*(*mini-batch*，每次$32$个数据[$\rm batchsize=32$]，训练$300$轮[$\rm epoch=300$])
![一维卷积预测模型](https://cdn.jsdelivr.net/gh/AmaneHayashi/PictureBed/20200630193547.png)

## 4 模型评估
### 4.1 流量预测结果分析
  - 按地理位置
    - 图像意义：时间确定时，每个网格的流量的预测值与真实值对比 
    - 结论：每个网格的移动流量预测结果与实际值接近(色调完全一致)
  - 按基站
    - 图像意义：(左)时间确定时，每个 基站的流量的预测值与真实值对 比；(右)基站确定时，一段时间内 的流量的预测值与真实值对比  
    - 结论：预测值与实际值的变化趋 势非常吻合 
![流量预测结果分析-按地理位置](https://cdn.jsdelivr.net/gh/AmaneHayashi/PictureBed/20200630193552.png)
![流量预测结果分析-按基站](https://cdn.jsdelivr.net/gh/AmaneHayashi/PictureBed/20200630193556.png)

### 4.2 预测误差与训练时长分析
  - 对比算法
    - *2-D CNN*：网格数为$40\times 40$
    - *LSTM*：$6$个隐藏层，每层$32$个*LSTM*单元
    - *SVR*：支持向量回归
  - 预测误差
    - 对比参数：基站均方根误差(*RMSE*)的算术平均值，式中$T$为小时数，$N$为基站数，$y$为实际值，$\hat{y}$为预测值
    $$\overline{RMSE}=\frac{\sum\limits_{n=1}^{N}\sqrt{\frac{1}{T}\sum\limits_{t=1}^{T}\left(y_{t}^{n}-\hat{y}_{t}^{n}\right)^2}}{N}$$
    - 结论： 
      - *1-D CNN*误差小于*LSTM*与*SVR* 
      - *1-D*与*2-D*的误差结果相近
  - 训练时长
    - 结论：在相近预测效果下，*1-D*(相比于*2-D*)节省了约$78\%$的时间成本 
![预测误差与训练时长分析](https://cdn.jsdelivr.net/gh/AmaneHayashi/PictureBed/20200630193559.png)

## 5 结论 
  - 研究过程：
    - 发现时空相关性：观察流量特征曲线并计算*Pearson*系数$\Rightarrow$发现时域自相关与空域互相关特性$\Rightarrow$一个良好的预测模型需要同时考虑时空特征
    - 流量预测建模：介绍一维网格流图建模方法$\Rightarrow$对高速场景蜂窝网络的移动流量进行建模
    - 模型评估与改进：使用一维卷积神经网络对一维网格流图进行学习$\Rightarrow$对高速场景基站的移动流量进行预测$\Rightarrow$基于*LSTM*与*SVR*，从预测曲线、预测误差、训练时长等角度改变模型参数并对比分析
  - 总结：
    - 使用一维密集连接*CNN*与一维网格流图建模方法，提出了新的高速场景蜂窝网络移动流量预测方案    
  - 结论：
    - 在具有一维分布特征(尤其是高速场景)的基站移动流量预测中，提出的移动流量预测方法具有卓越性能