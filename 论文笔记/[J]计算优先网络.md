# 算力网络(*Computing First Network*)
## 1 研究背景
### 1.1 发展现状
1. 定律
   - 摩尔定律：价格不变时，集成电路元器件数每隔18~24个月增加一倍，性能也提升一倍
   - 尼尔森定律：高端用户带宽以平均每年50%的增幅增长，每21个月带宽速率将增长一倍
   - 架构决定产业：当前互联网架构决定了运营商**不可避免地成为一个无差别的管道服务商**

2. 现状
   - *FTTH*/*5G*技术实现"超宽带/全连接"
     - 问题：什么是互联网产业的新愿景？
   - *SDN*/*NFV*走向"自动驾驶网络"，降低了*Opex*
     - 问题：运营商的用户数饱和，*ARPU*趋平，如何解决电信产业的收入问题？
   - 云计算面临"传不畅、算不动、存不下"的挑战
     - 预测：
       - 数据中心存储能力(2.6*ZB*) *vs* 网络流量(19.5*ZB*) 
       - 2021年，500亿终端+847*ZB*数据(10%需要计算)
     - 问题：如何解决当前云计算面临的挑战？
   - 方向
     - 关注计算系统的架构变化，有利于看清网络的发展
### 1.2 发展趋势
1. 应用解构为功能(*Serverless*架构)
   - 理解：**采用*FaaS*架构**，通过功能组合来实现应用程序逻辑
     - *FaaS*：函数即服务。应用以**函数**的形式存在，并由第三方云平台托管运行。
       - 原理：将代码上传云平台并配置触发器，实现触发式运行。
   - 变化：单体应用→(按业务模块拆分为)微服务→ (按使用场景模块拆分为)函数
   - 优点：
     - 服务端：事件触发函数，按需运行，**即需即用**
     - 客户端：无需关注计算地点和资源，**聚焦业务逻辑**

2. 计算载体更轻更快(*Unikernel*)
   - 理解：*Unikernel*是**精简(小)专属(单一用途)的**库操作系统。
   - 变化：
     - 只需**从一个服务库中选择应用需要的操作系统服务**，无须整个操作系统
     - 应用升级⇔*Unikernel*的重建和部署
   - 优点：更小，更快，更安全
3. 数字世界与物理世界深度融合
   - 理解：
     - 无处不在的泛在算力，边缘计算是趋势
       - 距离用户的**不同距离散布着不同规模的算力**(数百亿智能终端+数十亿家庭网关+移动边缘计算+云化数据中心)
     - 通过物联网的传感器与执行器，物理世界与数字世界互动融合
       - 网络与人工智能通过**数据、算力、算法**结合
   - 变化：未来*ICT*基础设施，关注点在于**如何获得计算资源、
   	   获得功能、获得计算结果**，而不是如何获得信息
4. 普适计算正在实现
   - 理解：普适计算相关技术领域已经发展到全新阶段。
     - 普适计算：在**任何时间、任何地点、以任何方式**进行信息的获取与处理
       - 提出：*Mark Weiser*，1991年
       - 理解：许许多多的设备通过全球网络为许多人提供个性化服务
   - 发展：
     - 信息空间、物理空间、社会空间的融合(物联网技术、社交网络、移动互联网技术等) 
     - 大量"围绕人的服务"(基础设施的广泛部署和智能终端的泛在嵌入，算力深入生活)
### 1.3 新变化与新需求
1. 新变化
   - 空间维度变化：计算**资源融入网络**，改变架构的拓扑假设
     - 原架构：网络在中间、计算在外围，主机通过网络实现逻辑/虚拟的全连接
     - 矛盾：“端到端”模型**不再适合于万物互联的"边缘/泛在计算"的场景**
   - 时间维度变化：计算**生命周期缩短**，改变架构的业务假设
     - 原架构：静态的服务端+移动的客户端
     - 矛盾： “部署应用→查找*IP* → 建立会话 ”的网络模式不再适合于**动态、轻量级的”*Serverless*+泛在计算”场景**

2. 问题与需求
   - 问题：
     - 如何利用边缘计算的能力，设计网络以适应未来计算的强动态性？
     - 如何均衡快速反应(**数据靠近计算**)与计算的经济性(**计算靠近数据**)的关系？
     - 普适计算的发展有哪些挑战？给未来网络或计算基础设施带来哪些机会？
   - 需求：**不同计算功能，按需求不同，按网络状况不同，可以在离客户端的不同距离，实时地实例化**。
3. 缺陷与机遇
   - 边缘计算的缺陷：
     - 业务**静态部署**，资源无法复用，存在闲置资源浪费
     - 计算资源节点之间(如*MEC*节点之间)**缺乏互动调度能力**，当计算资源过载甚至不可用时，等待时间秒/分钟级，将引起用户体验下降、甚至变得不可接受
     - **静态**预先**配置**，或者*DNS*解析的路由寻址方式，**效率低，开销大**，不适合于轻量级的计算资源
   
   <font color='gray'>**这些缺陷应由应用自行单点方案解决， 还是由网络提供更好的平台能力？**</font>
   - 机遇：**通过提供算力网络实现分布计算系统的全局优化**
     - 单个*MEC*站点的资源有限，为满足高性能并发访问，未来**大量分布化的*MEC*需要成网**
     - 当前业务系统规模越来越大，普遍采用分布式计算+分布式存储架构，从网络角度看**本质是从多个实例(多副本)中选择一个合适的实例提供服务**
     - *MEC*规模部署后，计算资源分散化，需要**按业务需求、资源负载、网络状况、成本等多维因素灵活调度计算任务**，从而提高资源利用率，降低业务运维成本，助力业务引入*MEC*
   
   <font color='gray'>**答案：网络应该内建计算任务动态路由的能力，以解决*MEC*部署复杂、效率低、资源复用率不高等问题**</font>
## 2 算力网络
### 2.1 原理与架构
1. 基本定义
   - 名称：算力网络 (*Computing First Network*, *CFN*)
   - 设计原则：**拉通网络中各分散计算资源，使用户尽快获得计算结果**
   - 本质：**实现边缘计算成网，实现边边协作，利用服务的多副本特性，实现用户的就近接入和服务的负载均衡，适应服务的动态性**
   - 愿景：**海量应用、海量功能函数、海量计算资源**构成一个开放的生态
     - 海量应用**按需、实时调用不同地方的计算资源**，提高用户体验
     - 海量功能函数在**不同计算资源上动态实例化**，提高计算资源利用效率
     - **少挪数据+根据网络状态改变计算位置**，数据/计算/网络整体优化实现效率体验最佳
     - 完善的**安全、隐私、激励**等机制

2. 原理
   - 路由域扩展到计算域→“服务容器”通过*OSPF/BGP*路由扩散
   - 计算感知路由→**算力状况和网络状况作为路由信息发布到网络**
   - *CFN/ServiceHaul*架构→三层*IP*网络实现*Service Anycast*
   - 面向服务的”网络重构”能力→ ***AI*自动优化网络路由参数**

    **技术特征：将计算能力状况和网络状况作为路由信息发布到网络，网络基于虚拟的服务*ID*将计算任务报文路由到最合适的计算节点，实现用户体验最优、计算资源利用率最优、网络效率最优。**
3. 架构
   - 新模型：计算网络融合模型(向日葵模型)：**云网融合，网随云动，云在网中**
   - 模型区别：
      
      |当前网络|*CFN*|
      |:---:|:---:| 
      |信息社会 |智能社会 |
      |用户使用互联网获取信息| 用户通过互联网获取计算的结果| 
      |端到端模型| 计算网络融合模型 |
      |网络在中间提供互联，计算在边缘| **计算嵌在网络中间，动态分布式计算** |
   - 架构区别：
      
      |传统网络|*CFN*|
      |:---:|:---:|
      |数据放在计算附近 |计算放在数据附近 
      |通信节点需要在通信前获得*IP*地址 |通信节点在通信前**不必须获得*IP*地址**
      |集中于数据中心的服务与单体应用 |分布于网络中的**微函数** 
      |复杂的处理流程与信息交换 |**带内**(*in-band*)管理程序 
      |传输依赖于稳定的端到端连接 |无连接 
      |传输时维持网络状态 |无状态的**函数功能链**
      |*IP*路由 |**基于对象的路由**，*IP*可重用 
      |业务流程与数据分离，连接与状态复杂 |函数与数据合一，**网络即函数计算** 

4. 原型与拓扑
   - *MWC*原型
     - 通过计算优先网络连接分布的*MEC*站点进行互助，演示使用*Service Anycast*动态路由的业务(辅助安全驾驶和360视频实时渲染)
   - 原型拓扑
     - *K8S*集群：*Kubernetes*集群(同一个业务，部署在多个服务器上)
     - *K8S apiserver*：提供了集群管理的*REST API*接口
   - 物理拓扑
### 2.2 模型与示例
1. 用户体验与成本模型
   - 模型分析
     - 用户体验优化目标：$min(\sum T_i)$&nbsp;(**$T$指时间**)
     - 成本优化目标：$min(\sum C_i)$&nbsp;(**$C$包括计算成本与带宽成本**)
   - 一般结论
     - 不同情况下的最佳优化目标没有唯一的答案
     - “计算”应放在数据附近，搬移数据只对计算密集的任务才是经济的(**数据重力说+计量经济学**)
     - *CFN*提供一个灵活动态、自适应的基础设施，减轻每个应用的判断负担

2. 工作示例
   - *CFN*尽量设计成"无状态"，报文组成：功能*ID*(*FuncID*)+输入数据*ID*(*DataIn*)+输出数据*ID*(*DataOut*)
   - 功能*ID*为主键(*primary key*)，用于转发请求(*forward request*)
   - *CFN*节点可以基于"输入数据*ID*"主动预取，使得功能执行时数据就在缓存中，降低时延


### 2.3 应用场景
1. 典型应用场景
   - 基于当前网络可用的计算算力和算法，结合网络实时状况，**通过*CFN*灵活匹配、动态调度计算资源，将终端的计算卸载到合适的边缘节点或者中心云节点**，支撑*AR*, *IoT*业务需求，保证业务体验
     - *AR*场景：DC中心云服务器进行训练，边缘 (包括家庭网关和边缘云)或者中心云进行识别，终端进行追踪和显示，将**终端的计算卸载到边缘或者中心云**
     - *IoT*场景：物联网终端设备因资源受限，具有计算能力较弱、存储空间较小的特点，利用边缘网关的计算能力将**数据处理、预处理等计算任务卸载、托管到边缘网关**
     - ***CFN*的作用：根据业务需求，结合网络实时状况和计算资源性能状况动态地进行算力灵活匹配**
        
        |*AR*场景| 目标追踪关注渲染| 物体识别| 识别训练|
        |:---:|:---:|:---:| :---:|
        |*IoT*场景| 数据采集| 数据处理/预处理| 数据存储数据同步|

2. 场景部署
   - 移动场景
     - 通过*CFN*技术**提供高效的*Service Haul*网络互联分布的*MEC*站点**，增强网络能力(包含核心网、*MEC*、承载网)，助力*MEC*规模部署
   - 固网场景
     - 拉通不同位置的*CO*边缘云和中心云构成融合业务网络，面向*OTT*提供**开放的计算和存储能力**，帮助*CO***向*In-Net Cloud*转型**
3. 应用举例
   - *AR/AI*云端识别
     - 服务端**提供识别服务**，客户端**采样并发出识别任务**，交给*CFN*去调度并返回计算结果
   - 视频云端实时渲染
     - 从**本地渲染到云上渲染**，通过分布化部署与*CFN*网络调度返回视频渲染结果
### 2.4 变化与挑战
1. 范式转换

|方面|当前网络|CFN|
|:---:|:---:|:---:|
|使用场景|信息社会: 用户使用互联网**获取信息** (*HTTP/TCP/IP*) |智能社会: 用户通过互联网**获取计算的结果** (算力+数据+算法) |
|开发策略 |基于***App Store*** (*client + rich server*) |基于***Function Store*** (*rich client + micro service*) |
|网络模型| 计算在**网络边缘** (端到端模型，海路图模型)| 计算在**网络中间** (算网融合模型，向日葵结构)  |

2. 产业生态链变化
   - 端-管-云
     - 用户、**应用开发者(*App store*)**、计算设施服务商(云服务商)、网络设施服务商(运营商)，**垂直封闭的各大”烟囱”**
   - 端-边-云
     - 用户+应用开发者+**功能服务商(*Function store*)**+开放协作的计算设施(算力/云)服务商(边缘计算)+甚至个人/终端的计算共享(众筹计算)，构建合作开放共赢
   - 垂直封闭
     - *DC*资源基本由几大*OTT*垄断，构成垂直生态，**运营商沦为”管道”**
     - 边缘计算存在僵局
     - 互联网公司**不可能重资投入**边缘计算
     - **海量**边缘节点的**调度管理**存在挑战 
     - **货币化变现**边缘计算资源，商业上**没有信心**
   - 开放共赢
     - **打破*OTT*垄断**的封闭生态，构建更开放的产业生态环境
       - 开放的*CFN*平台，**任何算力、算法**都可以按照自己的能力开放并发布到*CFN*中，每个服务、开发者都能**按需使用这些能力**
     - 新的交易模式催生**网络货币化**，资源提供者变现
       - 根据**算力和*Func*服务来购买付费**，*Func*服务商以及运营商的(边缘)计算资源能够”变现”
3. 问题与挑战
   - 问题
     - 架构和模型 
       - 保证**架构扩展性，支持海量计算资源**
       - 超越当今基于主机的端到端通信
       - 处理**失效、动态负载** 
       - **自管理的数据面设计**，尽量不依赖于”协同器” 等管理面的部件
       - **路由策略**
     - 用户体验，*QoS*
       - 在动态环境下，**保证足够强的一致体验** 
       - **动态变化适应策略** (自适应 *or* 资源预留)
     - 安全，信任，隐私 
       - 分布式系统**更容易受到攻击**
       - 计算资源使用、数据分享的**认证和授权** 
       - 计算功能和执行平台的**信任机制**
       - 个人隐私信息的**保密机制**
     - 经济激励
       - 关注**资源使用率、成本**等
       - 尝试微支付、智能合约等机制
   - 风险
     - 边缘计算**还没有普遍应用** 
     - 边缘架构**现有框架已覆盖**(*serverless*等) 
     - 需要**足够的好处和激励**，才能实现计算与网络的融合 
     - **应用层**解决方案的竞争
   - 挑战
     - 多副本(*Service Replication*)：通常要跨多个边缘提供服务的**多副本**，以**保证更好的性能和可靠性**。如何将客户端服务请求和终端数据引导到多个边缘站点以实现**负载均衡、可靠性**
     - 动态性(*Service Dynamism*)：由于**客户移动性、服务移动性**等原因，服务的位置可能会**跨边缘站点发生变化**，从而引发**主机的*IP*地址的改变**，导致会话中断
## 3 总结与展望
### 3.1 总结
1. 泛在的计算能力促使计算优先网络的提出
   - 应用解构成功能，计算载体更轻更快
   - 泛在算力，云计算面临挑战，边缘计算是趋势
   - 普适计算正在变为现实
   - 机会：提供网络方案做到分布计算系统的全局优化

2. *CFN* 探索新架构、新设备形态、新协议
   - *CFN*与传统互联网架构有本质区别(端到端→算网融合)
   - *CFN*的核心技术：
     - 新网络架构：云网融合，网随云动，云在网中
     - 新设备形态：*CFN* *Router*，分布计算集群互联
     - 新应用接口：通用计算接口，应用无关、语义不感知 
     - 开放路由协议：无状态基本层 + 开放扩展层
3. *CFN*的应用场景和商业价值
   - 应用场景：移动场景+固网场景(例: *AR*云端识别/视频渲染)
   - 商业价值：”端-管-云”到”端-边-云”
     - 运营商：*In-net Cloud*,  ”卖带宽”到”卖网内算力”
     - *OTT*：按需调用资源，节省分布化边缘节点的运维成本
### 3.2 未来规划
1. 初期：聚焦运营商*MEC*承载网络，通过*CFN*构建固定网络场景、移动网络场景、固移融合场景的*MEC*算力成网 
   - *CFN*需求、功能特征、技术架构、协议、接口等共同讨论与制定，达成共识形成国际国内标准 
   - 开展技术联合验证，通过实验局/现网*POC*，形成行业标杆
   - *CFN*白皮书联合撰稿与发布 

2. 后续：扩展到其他领域，如数据中心